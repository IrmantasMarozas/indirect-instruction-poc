<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Detection Strategies for Injection Attacks</title>
    <link rel="stylesheet" href="styles.css" />
    <style>
      .layer {
        background: white;
        border-left: 5px solid #3498db;
        padding: 1.5rem;
        margin: 1.5rem 0;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      }
      .effectiveness {
        display: inline-block;
        padding: 0.25rem 0.75rem;
        border-radius: 15px;
        font-size: 0.9rem;
        font-weight: bold;
        margin-left: 0.5rem;
      }
      .eff-high { background: #d4edda; color: #155724; }
      .eff-medium { background: #fff3cd; color: #856404; }
      .eff-low { background: #f8d7da; color: #721c24; }
      code {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 0.2rem 0.5rem;
        border-radius: 3px;
      }
      pre {
        background: #2c3e50;
        color: #ecf0f1;
        padding: 1rem;
        border-radius: 5px;
        overflow-x: auto;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <header>
        <h1>IINK Defense Framework: Prompt Injection</h1>
        <p class="subtitle">Category 1 - Multi-Layer Detection for Instruction Manipulation Attacks</p>
        <p style="font-size: 0.9rem; opacity: 0.9; margin-top: 0.5rem;">Part of the IINK AI Security Framework</p>
      </header>

      <nav class="card" style="background: #f8f9fa;">
        <a href="index.html">← Home</a> |
        <a href="attack-patterns.html">Attack Patterns</a> |
        <a href="test-suite.html">Test Suite</a> |
        <a href="visualizer.html">Visualizer</a> |
        <a href="demos/index.html">Demos</a>
      </nav>

      <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h2 style="color: white;">About This Defense Category</h2>
        <p>The <strong>IINK Defense Framework</strong> is a multi-layer AI security methodology. This page documents the <strong>Category 1: Prompt Injection</strong> defense implementation.</p>
        <p style="margin-top: 1rem;"><strong>Architecture:</strong> 5-layer detection system for instruction manipulation attacks</p>
        <p><strong>Coverage:</strong> 15 attack pattern categories</p>
        <p><strong>Effectiveness:</strong> 85-95% detection accuracy</p>
        <p style="margin-top: 1rem; font-size: 0.9rem;"><em>Additional defense categories for other AI vulnerabilities will be documented as research expands.</em></p>
      </div>

      <div class="card info-card">
        <h2>Overview</h2>
        <p>Detecting indirect instruction injection requires <strong>multi-layered approaches</strong> combining pattern matching, behavioral analysis, and contextual understanding. No single technique provides complete protection.</p>
        <p><strong>Key Principle:</strong> Defense in depth - multiple detection layers working together.</p>
        <p style="margin-top: 1rem;"><strong>Standards Alignment:</strong> This framework aligns with OWASP LLM Top 10:2025 and NIST AI security guidelines, incorporating both standard industry practices and experimental research approaches.</p>
      </div>

      <div class="card">
        <h2>5-Layer Detection Architecture</h2>
        <p><strong>Industry-Standard Layers (1, 4, 5):</strong> Based on OWASP and NIST recommendations</p>
        <p><strong>Experimental Layers (2, 3):</strong> Research-based enhancements for broader coverage</p>
      </div>

      <div class="layer">
        <h3>Layer 1: Input Validation & Pattern Matching <span class="effectiveness eff-medium">Effectiveness: 60-70%</span></h3>
        <p><strong>Industry Standard:</strong> OWASP LLM01:2025, NIST AI 600-1</p>

        <h4>What It Does:</h4>
        <ul>
          <li>Treats all user inputs as untrusted (OWASP recommendation)</li>
          <li>Scans for known instruction keywords: AGENT, ASSISTANT, SYSTEM</li>
          <li>Detects command-like phrases: "ignore previous", "disregard", "forget"</li>
          <li>Identifies verification requests and canary tokens</li>
          <li>Enforces strict input validation before processing</li>
        </ul>

        <h4>Implementation:</h4>
        <pre>const suspiciousPatterns = [
  /AGENT:/gi,
  /ASSISTANT:/gi,
  /ignore previous (instructions?|context)/gi,
  /disregard (all|everything|previous)/gi,
  /CANARY-[A-Z0-9-]+/gi
];

// OWASP recommendation: Treat all inputs as untrusted
function validateInput(input, source) {
  const isExternal = source !== 'system';
  return {
    sanitized: sanitizeInput(input),
    patterns: scanForPatterns(input),
    trusted: !isExternal
  };
}</pre>

        <h4>Industry Alignment:</h4>
        <p><strong>OWASP:</strong> Input validation and filtering to block malicious prompts</p>
        <p><strong>NIST:</strong> Parameter validation and input sanitization</p>

        <h4>Pros & Cons:</h4>
        <p><strong>Pros:</strong> Fast, easy to implement, catches obvious attacks, industry standard</p>
        <p><strong>Cons:</strong> Can be evaded with encoding, medium false positive rate</p>
      </div>

      <div class="layer">
        <h3>Layer 2: Structural Analysis <span class="effectiveness eff-high">Effectiveness: 70-80%</span></h3>
        <p><strong>Research Enhancement:</strong> Experimental approach beyond current standards</p>

        <h4>What It Does:</h4>
        <ul>
          <li>Detects hidden elements (display:none, visibility:hidden)</li>
          <li>Identifies suspicious comment content</li>
          <li>Flags unusual meta tag usage</li>
          <li>Detects steganographic encoding attempts</li>
        </ul>

        <h4>Why It Works:</h4>
        <p>Analyzes document structure and formatting rather than just text content, catching attacks that hide instructions using CSS or HTML tricks.</p>

        <h4>Industry Note:</h4>
        <p>This layer extends beyond current OWASP/NIST recommendations but addresses real attack vectors observed in research.</p>

        <h4>Pros & Cons:</h4>
        <p><strong>Pros:</strong> Catches hidden injections, low false positives</p>
        <p><strong>Cons:</strong> Only works on structured content (HTML, XML), not yet widely adopted</p>
      </div>

      <div class="layer">
        <h3>Layer 3: Semantic Analysis <span class="effectiveness eff-high">Effectiveness: 75-85%</span></h3>
        <p><strong>Research Enhancement:</strong> Advanced NLP-based detection</p>

        <h4>What It Does:</h4>
        <ul>
          <li>Analyzes semantic similarity to known injection patterns</li>
          <li>Detects context switching indicators</li>
          <li>Identifies imperative mood commands</li>
          <li>Flags unnatural phrasing or structure</li>
        </ul>

        <h4>Why It Works:</h4>
        <p>Uses NLP to understand <em>intent</em> rather than just matching keywords, catching paraphrased or cleverly worded attacks that bypass simple filters.</p>

        <h4>Industry Note:</h4>
        <p>While not explicitly in OWASP/NIST frameworks, semantic analysis addresses the reality that attackers use paraphrasing and synonyms to evade keyword-based detection.</p>

        <h4>Pros & Cons:</h4>
        <p><strong>Pros:</strong> Catches novel variations, understands context, resistant to evasion</p>
        <p><strong>Cons:</strong> Slower processing, requires ML models, cutting-edge approach</p>
      </div>

      <div class="layer">
        <h3>Layer 4: Runtime Behavioral Monitoring <span class="effectiveness eff-high">Effectiveness: 80-90%</span></h3>
        <p><strong>Industry Standard:</strong> OWASP 2026 recommendation, Microsoft AI security guidelines</p>

        <h4>What It Does:</h4>
        <ul>
          <li>Monitors for unexpected action sequences (runtime validation)</li>
          <li>Tracks external content influence on decisions</li>
          <li>Detects deviation from baseline behavior</li>
          <li>Flags rapid context switching</li>
          <li>Continuous validation during execution (industry best practice)</li>
        </ul>

        <h4>Implementation Example:</h4>
        <pre>class BehaviorMonitor {
  trackAction(action, source) {
    this.actionLog.push({ action, source, timestamp });

    if (this.isAnomalous(action, source)) {
      this.flagSuspiciousActivity(action, source);
    }
  }

  isAnomalous(action, source) {
    return this.deviatesFromBaseline(action) &&
           source === 'external_content';
  }
}</pre>

        <h4>Industry Alignment:</h4>
        <p><strong>OWASP 2026:</strong> "One of the most important shifts in 2026 is the move away from purely static assurance" - runtime monitoring is critical</p>
        <p><strong>Industry Consensus:</strong> Behavioral monitoring and continuous validation are now recognized as essential</p>

        <h4>Pros & Cons:</h4>
        <p><strong>Pros:</strong> Catches attacks that pass other layers, learns over time, industry-recommended</p>
        <p><strong>Cons:</strong> Requires baseline data, real-time overhead</p>
      </div>

      <div class="layer">
        <h3>Layer 5: Source Validation & Trust Boundaries <span class="effectiveness eff-high">Effectiveness: 85-95%</span></h3>
        <p><strong>Industry Standard:</strong> OWASP LLM Top 10:2025, Zero Trust Architecture</p>

        <h4>What It Does:</h4>
        <ul>
          <li>Separates trusted system instructions from untrusted user/external input (OWASP fundamental)</li>
          <li>Whitelists trusted domains and sources</li>
          <li>Verifies HTTPS and certificates</li>
          <li>Checks content freshness and modification dates</li>
          <li>Implements zero trust principles - verify all sources</li>
        </ul>

        <h4>Why It Works:</h4>
        <p>Prevents injection at the source - if content only comes from trusted origins, attack surface is dramatically reduced. Aligns with OWASP's fundamental principle: "Isolating system prompts from user input."</p>

        <h4>Industry Alignment:</h4>
        <p><strong>OWASP:</strong> "The fundamental procedure to prevent prompt injection attacks is isolating system prompts from user input"</p>
        <p><strong>NIST:</strong> Zero trust architecture and least privilege principles</p>

        <h4>Pros & Cons:</h4>
        <p><strong>Pros:</strong> Very high effectiveness, low false positives, industry-proven approach</p>
        <p><strong>Cons:</strong> Requires whitelist maintenance, limits flexibility</p>
      </div>

      <div class="card" style="background: #f8f9fa;">
        <h2>Recommended Detection Pipeline</h2>
        <div style="background: white; padding: 1.5rem; border-radius: 5px; margin-top: 1rem;">
          <p style="text-align: center; font-family: monospace; line-height: 2;">
            Content Retrieval<br>
            ↓<br>
            <strong>Layer 5: Source Validation</strong><br>
            ↓ (if passes)<br>
            <strong>Layer 1: Pattern Matching</strong><br>
            ↓ (if suspicious)<br>
            <strong>Layer 2: Structural Analysis</strong><br>
            ↓ (if still suspicious)<br>
            <strong>Layer 3: Semantic Analysis</strong><br>
            ↓ (continuous)<br>
            <strong>Layer 4: Behavioral Monitoring</strong><br>
            ↓<br>
            Decision: Allow / Flag / Block
          </p>
        </div>
      </div>

      <div class="card">
        <h2>Risk Score Thresholds</h2>
        <p>Use these thresholds to decide on actions:</p>
        <ul>
          <li><strong>0.0 - 0.2:</strong> Safe - allow without restrictions</li>
          <li><strong>0.2 - 0.4:</strong> Low risk - allow with logging</li>
          <li><strong>0.4 - 0.6:</strong> Medium risk - require user confirmation</li>
          <li><strong>0.6 - 0.8:</strong> High risk - block with notification</li>
          <li><strong>0.8 - 1.0:</strong> Critical - block and alert security team</li>
        </ul>
      </div>

      <div class="card warning-card">
        <h2>Common Evasion Techniques</h2>
        <p>Attackers may attempt to evade detection through:</p>
        <ul>
          <li><strong>Obfuscation:</strong> Character substitution, spacing tricks</li>
          <li><strong>Encoding:</strong> Base64, Unicode, hex encoding</li>
          <li><strong>Semantic Variations:</strong> Synonyms, paraphrasing</li>
          <li><strong>Timing Attacks:</strong> Delayed activation</li>
        </ul>

        <h3>Counter-Measures:</h3>
        <ul>
          <li>Normalize content before analysis</li>
          <li>Decode common encodings automatically</li>
          <li>Use semantic similarity rather than exact matching</li>
          <li>Monitor temporal behavior patterns</li>
        </ul>
      </div>

      <div class="card warning-card">
        <h2>Additional Industry-Standard Defenses (Not Yet Implemented)</h2>
        <p>According to OWASP LLM Top 10:2025 and NIST guidelines, these additional layers should be considered:</p>
        <ul>
          <li><strong>Instruction Isolation:</strong> Keep system prompts completely separate from user/external content (OWASP fundamental)</li>
          <li><strong>Output Filtering:</strong> Validate and sanitize all model outputs before execution (OWASP/NIST recommendation)</li>
          <li><strong>Least Privilege:</strong> Limit AI agent permissions and access scope (NIST zero trust)</li>
          <li><strong>Containment Strategy:</strong> Assume prompt injection will succeed, focus on damage limitation (OWASP 2026 guidance)</li>
        </ul>
        <p style="margin-top: 1rem;"><em>Note: These represent industry standards not yet implemented in the current IINK framework but planned for future development.</em></p>
      </div>

      <div class="card">
        <h2>Testing Your Detection System</h2>
        <p>Validate your implementation against this project's resources:</p>
        <div style="margin-top: 1rem;">
          <a href="test-suite.html" class="btn">Run Automated Test Suite</a>
          <a href="demos/index.html" class="btn btn-danger">Test Against Live Demos</a>
          <a href="visualizer.html" class="btn">Use Pattern Visualizer</a>
        </div>
      </div>

      <div class="card info-card">
        <h2>Industry Standards References</h2>
        <p>This framework aligns with and references:</p>
        <ul>
          <li><strong>OWASP LLM Top 10:2025</strong> - LLM01: Prompt Injection</li>
          <li><strong>NIST AI 600-1</strong> - Trustworthy and Responsible AI guidelines</li>
          <li><strong>NIST Cybersecurity Framework Profile for AI</strong> (2025 draft)</li>
          <li><strong>Zero Trust Architecture</strong> - NIST SP 800-207</li>
        </ul>
        <p style="margin-top: 1rem;"><em>Personal hobby project interpretation of industry standards - not officially endorsed.</em></p>
      </div>

      <div class="card">
        <h2>Implementation Resources</h2>
        <p>See the complete detection strategies document for:</p>
        <ul>
          <li>Detailed code examples for each layer</li>
          <li>Machine learning approaches</li>
          <li>Anomaly detection techniques</li>
          <li>Ensemble methods</li>
          <li>Performance optimization strategies</li>
          <li>Real-world deployment considerations</li>
        </ul>
        <p><a href="detection-strategies.md">View complete markdown version</a></p>
      </div>

      <div class="card">
        <p><a href="attack-patterns.html" class="btn">Attack Patterns Catalog</a></p>
        <p><a href="index.html" class="btn">Back to Home</a></p>
      </div>

      <footer>
        <p>Last Updated: 2026-02-01</p>
      </footer>
    </div>
  </body>
</html>
